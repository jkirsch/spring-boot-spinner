var translations_EN={TITLE:"Random Name Selector",ADD:"Add a new label",EMPTY_TEXT:"Enter something",NAME:"Name",SELECTED:"Selected #",SPIN:"randomize",WINNER:"selected",CLIENTS:"Currently we have {{ clients }} clients."},translations_DE={TITLE:"Zufallsnamen W\u00e4hlscheibe",ADD:"Name hinzuf\u00fcgen",EMPTY_TEXT:"Text eingeben",NAME:"Name",SELECTED:"Ausgew\u00e4hlt #",SPIN:"Drehen",WINNER:"Ausgew\u00e4hlt",CLIENTS:"Es schauen gerade: {{ clients }} zu."},myApp=angular.module("spinner",["spinner.controllers",
"spinner.directives","ngAnimate","pascalprecht.translate"]).config(["$translateProvider",function(a){a.translations("en",translations_EN).translations("de",translations_DE).registerAvailableLanguageKeys(["en","de"],{"en-*":"en","de-*":"de"}).uniformLanguageTag("bcp47").determinePreferredLanguage().fallbackLanguage("en")}]);
angular.module("spinner.controllers",["spinner.services","toaster"]).controller("EntriesCtrl",["$scope","myService","toaster","$timeout","$log","$window","$translate",function(a,d,h,m,e,f,k){function q(){e.log("STOMP: Attempting connection");r=new SockJS("/spinner");g=Stomp.over(r);g.connect({},t,u)}var r,g;a.participants=[];a.winner="";a.newName="";a.connected=0;a.spinning=!1;a.add=function(b){b={name:a.newName.trim()};h.clear("*");d.create(b).then(function(c){a.newName=""},function(a){h.pop("error",
"Backend error",a.message);e.log(a)})};var l=function(b){a.spinning||(n.update(p()),a.$apply())},v=function(b){a.spinning=!0;var c;for(c=0;c<a.participants.length&&a.participants[c].id!==b.id;c++);n.update(p());var d=n.spin(360/a.participants.length*(a.participants.length-c-1)+360+360/a.participants.length/2+7200);m(function(){a.winner=b;a.participants[c]=b;a.spinning=!1;a.$apply();k(["WINNER"]).then(function(a){h.pop("success",a.WINNER,b.name)})},d.duration)},t=function(b){e.log("Connected "+b);
g.subscribe("/app/participants",function(c){c=angular.fromJson(c.body);a.participants=c.entries;a.connected=c.connected;l()});g.subscribe("/topic/added",function(c){c=angular.fromJson(c.body);a.participants.push(c);l()});g.subscribe("/topic/deleted",function(c){c=angular.fromJson(c.body);var b;for(b=0;b<a.participants.length&&a.participants[b].id!==c;b++);a.participants.splice(b,1);l()});g.subscribe("/topic/spin",function(a){v(angular.fromJson(a.body))});g.subscribe("/topic/count",function(b){b=angular.fromJson(b.body);
a.connected=b;l()})},u=function(b){a.connected=0;l();e.log("STOMP: "+b);m(q,1E4);e.log("STOMP: Reconnecting in 10 seconds")};q();a.remove=function(a){g.send("/app/remove",{},JSON.stringify(a.id))};var p=function(){var b=[];angular.forEach(a.participants,function(a){this.push(a.name.substring(0,8))},b);return b};f=Math.min(f.innerWidth/2,220)-20;var n=new Spinner("#spinnerContainer",{margins:{top:40,right:10,bottom:10,left:10},outerR:f,h:450,w:2*f+20,data:p()});a.spin=function(){h.clear("*");d.spin().then(function(b){a.winner=
""},function(a){h.pop("error","Backend error",a.message);e.log(a)})};a.info=function(){k("CLIENTS",{clients:a.connected}).then(function(a){h.pop("info","Clients",a)})}}]);
myApp=angular.module("spinner.services",[]).factory("myService",["$http",function(a){return{create:function(d){return a.post("participants/",d).then(function(a){return a.data},function(a,d,e,f){var k;a.data&&(k=a.data.message);throw Error(k||"Can't talk to server - server down?");})},spin:function(){return a.get("participants/random").then(function(a){return a.data},function(a,h,m,e){var f;a.data&&(f=a.data.message);throw Error(f||"Can't talk to server - server down?");})}}}]);
angular.module("spinner.directives",[]).directive("zodiac",function(){return{template:'<canvas id="zodiac"></canvas>',restrict:"E",link:function(a,d){new Zodiac(d.children()[0],{directionX:0,directionY:-1,velocityX:[.1,.3],velocityY:[.3,.7],bounceX:!0,bounceY:!1,parallax:.2,pivot:0,density:9999,dotRadius:[1,5],linkColor:"#FFDAB9",linkDistance:55,linkWidth:2})}}});